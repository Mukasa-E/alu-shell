#!/usr/bin/env bash

# This script manages the my_process process (start, stop, restart)

PID_FILE="/var/run/my_process.pid"

start_process() {
  if [[ -f "$PID_FILE" ]]; then
    echo "Process already running with PID $(cat "$PID_FILE")"
    exit 1
  fi

  ./manage_my_process &  # Start the process in the background
  echo "$!" > "$PID_FILE"
  echo "manage_my_process started with PID $(cat "$PID_FILE")"
}

stop_process() {
  if [[ -f "$PID_FILE" ]]; then
    kill "$(cat "$PID_FILE")"
    rm "$PID_FILE"
    echo "manage_my_process stopped"
  else
    echo "No running process found"
  fi
}

restart_process() {
  stop_process
  start_process
}

if [[ "$#" == "1" ]]; then
  case "$1" in
    start)
      start_process
      ;;
    stop)
      stop_process
      ;;
    restart)
      restart_process
      ;;
    *)
      echo "Usage: $0 {start|stop|restart}"
      ;;
  esac
else
  echo "Usage: $0 {start|stop|restart}"
fi

